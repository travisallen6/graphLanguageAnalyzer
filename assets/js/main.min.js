function onlyUnique(e,a,t){return t.indexOf(e)===a}function cleanInput(e){return e=(e=(e=e.replace(/[&\/\\#,+()$~%.'":|!@;*?<>{}\-\.]/g,"").toLowerCase()).replace(/\ {2,}/g," ")).replace(/\n/g," ")}function generateGraph(e,a){var t=a.split(" ");t.forEach(function(e,a,t){""!==e&&" "!=e||t.splice(a,1)}),(t=t.filter(onlyUnique)).forEach(function(e,a,t){t[a]=e.split("")}),e.elements().remove();var r={letter:"$",l_index:"$",index:"$",check:!1},n=!1,l=new Array;e.add({group:"nodes",data:{id:"start",tag:"start"}}),t.forEach(function(a,t,o){previousRepeat=!0,l=new Array,a.forEach(function(a,o,c){if(o>0)var d=e.$('node[tag = "'+a+'"][l_index = '+o+'][start = "'+c[0]+'"][left = "'+c[o-1]+'"]');else d=e.$('node[tag = "'+a+'"][l_index = '+o+'][start = "'+c[0]+'"]');var s=new Array,i=new Boolean;if(i=o==c.length-1?1:0,null!=d[0]&&0!=o&&previousRepeat){if(d.forEach(function(e,a,t){s.push(e)}),null!=(u=e.edges('[id = "'+l[0].data("tag")+"_"+a+"_"+s[0].data("index")+"_"+o+'"]'))[0]){var g=u[0].data("tag");u[0].data("tag",g+1)}l=s}else if(null!=d[0]&&0==o&&previousRepeat){d.forEach(function(e,a,t){s.push(e)}),l=s;var u;g=(u=e.edges('[id = "'+a+'_start"]'))[0].data("tag");u[0].data("tag",g+1)}else l=[],previousRepeat=!1;(n=d.length!=e.collection().length&&1==previousRepeat)?(r.letter=l[0].data("tag"),r.l_index=l[0].data("l_index"),r.index=l[0].data("index"),r.check=n,1==i&&l[0].data("end",1)):(previousRepeat=!1,e.add({group:"nodes",data:{id:a+"_"+t+"_"+o,tag:a,l_index:o,index:t,left:r.letter,right:a,start:c[0],end:i,search:0}}),o>0?e.add({group:"edges",data:{id:r.letter+"_"+a+"_"+t+"_"+o,left:r.letter,right:a,tag:1,source:r.letter+"_"+r.index+"_"+r.l_index,target:a+"_"+t+"_"+o,search:0}}):0==o&&e.add({group:"edges",data:{id:a+"_start",left:"start",right:a,tag:1,source:"start",target:a+"_"+t+"_"+o,search:0}}),r={letter:a,l_index:o,index:t,check:n})})}),e.layout({name:"cose-bilkent"}).run()}function searchSubGraphSylabs(e,a){if(a.length>0)var t=e.nodes('[tag = "'+a[0]+'"]');t.forEach(function(e,t,r){second=e.neighborhood('[tag = "'+a[1]+'"][left = "'+a[0]+'"][l_index = '+(e.data("l_index")+1)+"]"),second.length>0&&second.forEach(function(a,t,r){console.log(e,a),e.data("search",1),a.data("search",1),search_edge=e.edgesWith(a),search_edge.data("search",1)})})}$(function(){var e=cytoscape({container:document.getElementById("cy"),wheelSensitivity:1,style:[{selector:"node",style:{shape:"ellipse","background-color":"grey",label:"data(tag)"}},{selector:"edge",style:{label:"data(tag)","line-color":"aqua",width:2,"curve-style":"bezier","target-arrow-shape":"vee","target-arrow-color":"aqua"}},{selector:"node[l_index = 0]",style:{shape:"hexagon","background-color":"red",label:"data(tag)"}},{selector:"node[end = 1]",style:{shape:"tag","background-color":"blue",label:"data(tag)"}},{selector:'node[id = "start"]',style:{shape:"star","background-color":"green",label:"data(tag)"}},{selector:"node[search = 1]",style:{"background-color":"black"}},{selector:"edge[search = 1]",style:{"line-color":"purple","target-arrow-color":"purple"}}]});$("form").submit(function(e){e.preventDefault()}),$("#analyzeIt").on("click",function(){var a=$("#toAnalyze").val();a=cleanInput(a),generateGraph(e,a)}),$("#analyzeCrap").on("click",function(){var a=$("#toAnalyze").val();generateGraph(e,a)}),$("#analyzeEnteredSylabs").on("click",function(){var a=$("#analyzeSylabsTextbox").val(),t=$("#toAnalyze").val();t=cleanInput(t),generateGraph(e,t),searchFor=cleanInput(a),searchSubGraphSylabs(e,searchFor)}),$("#analyzeEnteredSylabsSpecial").on("click",function(){var a=$("#analyzeSylabsTextbox").val(),t=$("#toAnalyze").val();generateGraph(e,t),searchFor=cleanInput(a),searchSubGraphSylabs(e,searchFor)}),e.on("tap",function(e){var a=e.target;console.log("Clicked:",a)})});